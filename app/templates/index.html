{% extends "base.html" %}

{% block title %}部署到 HuggingFace Spaces{% endblock %}

{% block content %}
<!-- Hero Section -->
<div class="hero bg-gradient-to-r from-primary to-secondary text-primary-content rounded-xl mb-8">
    <div class="hero-content text-center py-16">
        <div class="max-w-md">
            <h1 class="text-5xl font-bold mb-6">
                <i data-lucide="rocket" class="w-12 h-12 inline mb-2"></i>
                一键部署
            </h1>
            <p class="text-lg opacity-80">
                将您的代码快速部署到 HuggingFace Spaces，享受免费的托管服务
            </p>
        </div>
    </div>
</div>

<!-- Features -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
    <div class="card bg-base-200 shadow-xl">
        <div class="card-body items-center text-center">
            <i data-lucide="zap" class="w-12 h-12 text-warning mb-4"></i>
            <h2 class="card-title">快速部署</h2>
            <p>只需提供 Git 仓库，即可一键部署到 HuggingFace Spaces</p>
        </div>
    </div>
    <div class="card bg-base-200 shadow-xl">
        <div class="card-body items-center text-center">
            <i data-lucide="shield-check" class="w-12 h-12 text-success mb-4"></i>
            <h2 class="card-title">安全可靠</h2>
            <p>使用您的 HuggingFace Token，确保部署过程安全可控</p>
        </div>
    </div>
    <div class="card bg-base-200 shadow-xl">
        <div class="card-body items-center text-center">
            <i data-lucide="monitor" class="w-12 h-12 text-info mb-4"></i>
            <h2 class="card-title">实时监控</h2>
            <p>实时查看部署进度，获取详细的状态反馈</p>
        </div>
    </div>
</div>

<!-- Deploy Form -->
<div class="card bg-base-100 shadow-2xl">
    <div class="card-body">
        <h2 class="card-title text-2xl mb-6">
            <i data-lucide="settings" class="w-6 h-6"></i>
            配置部署参数
        </h2>
        
        <form 
            hx-post="/web/deploy" 
            hx-target="#deploy-result" 
            hx-swap="innerHTML"
            hx-indicator="#loading-indicator"
            class="space-y-6"
        >
            <!-- HuggingFace Token -->
            <div class="form-control">
                <label class="label">
                    <span class="label-text font-semibold">
                        <i data-lucide="key" class="w-4 h-4 inline mr-1"></i>
                        HuggingFace Token *
                    </span>
                    <span class="label-text-alt">
                        <a href="https://huggingface.co/settings/tokens" target="_blank" class="link link-info">
                            获取 Token
                        </a>
                    </span>
                </label>
                <input 
                    type="password" 
                    name="hf_token" 
                    placeholder="hf_..." 
                    class="input input-bordered w-full" 
                    required
                >
                <label class="label">
                    <span class="label-text-alt text-warning">需要具有写入权限的 Token</span>
                </label>
            </div>

            <!-- Git Repository URL -->
            <div class="form-control">
                <label class="label">
                    <span class="label-text font-semibold">
                        <i data-lucide="git-branch" class="w-4 h-4 inline mr-1"></i>
                        Git 仓库 URL *
                    </span>
                </label>
                <input 
                    type="url" 
                    name="git_repo_url" 
                    placeholder="https://github.com/username/repo.git" 
                    class="input input-bordered w-full" 
                    required
                >
                <label class="label">
                    <span class="label-text-alt">支持 GitHub、GitLab 等 Git 仓库</span>
                </label>
            </div>

            <!-- Space Name -->
            <div class="form-control">
                <label class="label">
                    <span class="label-text font-semibold">
                        <i data-lucide="tag" class="w-4 h-4 inline mr-1"></i>
                        Space 名称 *
                    </span>
                </label>
                <input 
                    type="text" 
                    name="space_name" 
                    placeholder="my-awesome-app" 
                    class="input input-bordered w-full" 
                    pattern="[a-zA-Z0-9_-]+" 
                    required
                >
                <label class="label">
                    <span class="label-text-alt">只能包含字母、数字、下划线和连字符</span>
                </label>
            </div>

            <!-- Description -->
            <div class="form-control">
                <label class="label">
                    <span class="label-text font-semibold">
                        <i data-lucide="file-text" class="w-4 h-4 inline mr-1"></i>
                        应用描述
                    </span>
                </label>
                <textarea 
                    name="description" 
                    placeholder="描述您的应用功能..." 
                    class="textarea textarea-bordered h-24"
                ></textarea>
            </div>

            <!-- Advanced Settings -->
            <div class="collapse collapse-arrow bg-base-200">
                <input type="checkbox" />
                <div class="collapse-title text-lg font-medium">
                    <i data-lucide="sliders" class="w-4 h-4 inline mr-2"></i>
                    高级设置
                </div>
                <div class="collapse-content space-y-4">
                    <!-- Port -->
                    <div class="form-control">
                        <label class="label">
                            <span class="label-text font-semibold">
                                <i data-lucide="wifi" class="w-4 h-4 inline mr-1"></i>
                                应用端口
                            </span>
                        </label>
                        <input 
                            type="number" 
                            name="space_port" 
                            value="7860" 
                            min="1" 
                            max="65535" 
                            class="input input-bordered w-full"
                        >
                    </div>

                    <!-- Privacy -->
                    <div class="form-control">
                        <label class="label cursor-pointer">
                            <span class="label-text font-semibold">
                                <i data-lucide="lock" class="w-4 h-4 inline mr-1"></i>
                                私有 Space
                            </span>
                            <input type="checkbox" name="private" class="checkbox checkbox-primary" />
                        </label>
                    </div>

                    <!-- Environment Variables -->
                    <div class="form-control">
                        <label class="label">
                            <span class="label-text font-semibold">
                                <i data-lucide="terminal" class="w-4 h-4 inline mr-1"></i>
                                环境变量
                            </span>
                        </label>
                        <textarea 
                            name="env_vars_text" 
                            placeholder="API_KEY=your_api_key&#10;DEBUG=true&#10;PORT=8080" 
                            class="textarea textarea-bordered h-24 font-mono text-sm"
                        ></textarea>
                        <label class="label">
                            <span class="label-text-alt">每行一个，格式：KEY=VALUE</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Submit Button -->
            <div class="form-control mt-8">
                <button type="submit" class="btn btn-primary btn-lg w-full">
                    <i data-lucide="rocket" class="w-5 h-5 mr-2"></i>
                    开始部署
                </button>
            </div>
        </form>

        <!-- Loading Indicator -->
        <div id="loading-indicator" class="htmx-indicator mt-6">
            <div class="flex items-center justify-center space-x-3">
                <div class="loading loading-spinner loading-md text-primary"></div>
                <span class="text-lg">正在提交部署请求...</span>
            </div>
        </div>
    </div>
</div>

<!-- Deploy Result -->
<div id="deploy-result" class="mt-8"></div>

<!-- Instructions -->
<div class="alert alert-info mt-8">
    <i data-lucide="info" class="w-5 h-5"></i>
    <div>
        <h3 class="font-bold">部署说明</h3>
        <div class="text-sm mt-2">
            <p>• 确保您的仓库包含 <code class="bg-base-300 px-1 rounded">Dockerfile</code></p>
            <p>• HuggingFace Token 需要具有写入权限</p>
            <p>• 部署过程可能需要几分钟时间</p>
            <p>• 支持 Docker 化的应用程序</p>
        </div>
    </div>
</div>
{% endblock %} 